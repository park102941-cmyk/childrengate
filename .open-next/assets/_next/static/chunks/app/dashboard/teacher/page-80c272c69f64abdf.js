(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7e3],{11591:(e,t,n)=>{Promise.resolve().then(n.bind(n,26051))},26051:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>u});var a=n(95155),s=n(12115),i=n(83935),r=n(44595),o=n(28633),d=n(11054),c=n(65236),l=n(35288),m=n(73239),p=n(1466),h=n(66889),x=n(95603),b=n(183);function u(){let{t:e}=(0,b.o)(),[t,n]=(0,s.useState)([]),[u,g]=(0,s.useState)(!0);(0,s.useEffect)(()=>{if(!r.db)return;let e=(0,i.P)((0,i.rJ)(r.db,"pickup_requests"),(0,i._M)("status","==","pending"),(0,i.My)("requestTime","desc")),t=(0,i.aQ)(e,e=>{n(e.docs.map(e=>({id:e.id,...e.data()}))),g(!1),e.docChanges().some(e=>"added"===e.type)&&new Audio("/notification.mp3").play().catch(()=>{})});return()=>t()},[]);let f=async e=>{try{if(!r.db)throw Error("Firebase database is not initialized");await (0,i.mZ)((0,i.H9)(r.db,"pickup_requests",e.id),{status:"approved",approvedAt:i.Dc.now()}),fetch("/api/sync-report",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"PICKUP_COMPLETED",studentName:e.studentName,className:e.className,parentName:e.parentName,timestamp:new Date().toISOString(),status:"APPROVED"})}).catch(e=>console.error("Reporting sync failed:",e)),console.log("Approved and Synced pickup:",e.id)}catch(e){console.error("Error approving pickup:",e)}},y=e=>{let t=window.open("","_blank");t&&(t.document.write("\n        <html>\n          <head>\n            <title>CG Sticker - ".concat(e.studentName,'</title>\n            <style>\n              @page { size: 50mm 30mm; margin: 0; }\n              body { \n                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;\n                margin: 0; \n                padding: 1.5mm;\n                width: 50mm;\n                height: 30mm;\n                display: flex;\n                flex-direction: column;\n                justify-content: space-between;\n                box-sizing: border-box;\n                background: white;\n                overflow: hidden;\n              }\n              .header { \n                display: flex; \n                justify-content: space-between; \n                align-items: flex-start; \n                border-bottom: 0.5pt solid #000;\n                padding-bottom: 0.5mm;\n              }\n              .brand { font-size: 7pt; font-weight: 900; color: #000; letter-spacing: -0.2pt; }\n              .class-info { font-size: 6.5pt; font-weight: bold; color: #444; }\n              \n              .main-content {\n                flex-grow: 1;\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                padding: 1mm 0;\n              }\n              .student-name { \n                font-size: 20pt; \n                font-weight: 900; \n                letter-spacing: -1pt; \n                line-height: 1; \n                margin: 0; \n                color: #000;\n              }\n              \n              .footer { \n                display: flex; \n                justify-content: space-between; \n                align-items: flex-end; \n                padding-top: 0.5mm;\n              }\n              .time { font-size: 6pt; font-weight: bold; color: #666; }\n              .barcode-placeholder { \n                font-family: monospace; \n                font-size: 6pt; \n                letter-spacing: 0.5pt;\n                background: #000;\n                color: #fff;\n                padding: 1pt 3pt;\n                border-radius: 1pt;\n              }\n              .barcode-visual {\n                font-size: 10pt;\n                letter-spacing: 2pt;\n                line-height: 1;\n              }\n            </style>\n          </head>\n          <body>\n            <div class="header">\n              <span class="brand">CG CHILDREN GATE</span>\n              <span class="class-info">').concat(e.className,'</span>\n            </div>\n            \n            <div class="main-content">\n              <h1 class="student-name">').concat(e.studentName,'</h1>\n            </div>\n            \n            <div class="footer">\n               <span class="time">').concat(new Date().toLocaleTimeString("ko-KR",{hour:"2-digit",minute:"2-digit"}),'</span>\n               <div style="text-align: right">\n                 <div class="barcode-visual">|||| ||| || |||</div>\n                 <div class="barcode-placeholder">').concat(e.id.substring(0,8).toUpperCase(),"</div>\n               </div>\n            </div>\n            <script>\n              window.onload = function() { \n                setTimeout(function() {\n                  window.print(); \n                  window.close(); \n                }, 300);\n              }\n            <\/script>\n          </body>\n        </html>\n      ")),t.document.close())};return(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 p-6 md:p-12",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,a.jsxs)("header",{className:"flex justify-between items-center mb-12",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold tracking-tight text-black",children:e.dashboard.teacher.title}),(0,a.jsx)("p",{className:"text-black/60 font-medium",children:e.dashboard.teacher.subtitle})]}),(0,a.jsx)("button",{className:"p-3 rounded-2xl bg-white border border-black/5 hover:bg-gray-100 transition-all text-black/70 shadow-sm",children:(0,a.jsx)(c.A,{size:20})})]}),(0,a.jsxs)("section",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-4",children:[(0,a.jsx)(l.A,{size:18,className:"text-primary"}),(0,a.jsxs)("h2",{className:"font-semibold",children:[e.dashboard.teacher.realtimeRequests," (",t.length,")"]})]}),(0,a.jsx)(o.N,{mode:"popLayout",children:0===t.length?(0,a.jsxs)(d.P.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-white rounded-3xl p-12 text-center border border-dashed border-gray-200",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)(m.A,{className:"text-gray-300"})}),(0,a.jsx)("p",{className:"text-secondary",children:e.dashboard.teacher.noRequests})]}):t.map(t=>(0,a.jsxs)(d.P.div,{layout:!0,initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,scale:.9},className:"bg-white rounded-3xl p-6 shadow-sm border border-gray-100 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-4",children:[(0,a.jsx)("div",{className:"w-14 h-14 bg-primary/10 rounded-2xl flex items-center justify-center text-primary",children:(0,a.jsx)(p.A,{size:28})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-xs font-extra-bold text-primary uppercase tracking-widest",children:t.className}),(0,a.jsx)("h3",{className:"text-xl font-bold text-black",children:t.studentName}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mt-1 text-sm font-medium text-black/60",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(h.A,{size:14,className:"text-primary"}),t.requestTime.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),(0,a.jsx)("span",{className:"text-black/20",children:"â€¢"}),(0,a.jsxs)("span",{children:[t.parentName," ",e.dashboard.teacher.guardian]})]})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{onClick:()=>y(t),className:"p-4 rounded-2xl bg-gray-50 text-secondary hover:bg-gray-100 transition-colors",title:e.dashboard.teacher.sticker,children:(0,a.jsx)(x.A,{size:20})}),(0,a.jsx)("button",{onClick:()=>f(t),className:"px-6 py-4 rounded-2xl bg-primary text-white font-bold hover:bg-primary-hover transition-colors shadow-lg shadow-primary/20",children:e.dashboard.teacher.approve})]})]},t.id))})]})]})})}},44595:(e,t,n)=>{"use strict";n.d(t,{db:()=>l,j2:()=>c});var a=n(49904),s=n(5877),i=n(83935);let r={apiKey:"AIzaSyDJm5vG3oeZUUMlVZXJqxkxo_dWE9SgPCc",authDomain:"schedulo-b0491.firebaseapp.com",projectId:"schedulo-b0491",storageBucket:"schedulo-b0491.firebasestorage.app",messagingSenderId:"1067549095640",appId:"1:1067549095640:web:822a85c7d3b16ead2cc9ad"},o=null;function d(){return o||(o=(0,a.Dk)().length>0?(0,a.Sx)():(0,a.Wp)(r)),o}let c=(0,s.xI)(d()),l=(0,i.aU)(d());d()}},e=>{var t=t=>e(e.s=t);e.O(0,[7153,5563,7767,5714,6608,2052,183,8441,1517,7358],()=>t(11591)),_N_E=e.O()}]);